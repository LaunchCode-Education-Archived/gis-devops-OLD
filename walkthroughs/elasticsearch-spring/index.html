<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Walkthrough: Elasticsearch in Spring :: GIS DevOps</title>

        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/highlight.launchcode.css">
        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body id='page-walkthrough-elasticsearch-in-spring'>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/objectives/">
                                        Objectives
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/resources/">
                                        Resources
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/about/">
                                        About This Course
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>

            <div>
                <a class="navbar-brand site-title navbar-center" href="https://education.launchcode.org/gis-devops/">
                    <h1>GIS DevOps</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="https://education.launchcode.org/gis-devops/"></a>
            </div>

        </header>

        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search GIS DevOps</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "014657181352409571810:oq1krtyri4k";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-2 col-sm-8">
                                        <h1>Walkthrough: Elasticsearch in Spring</h1>
                    <p>We'll walk through the steps to integrate Elasticsearch with Spring, using the Launchcart application.</p>
<h2 id="integrating-elasticsearch">Integrating Elasticsearch</h2>
<p>We'll walk through several steps needed to use Elasticsearch within Spring.</p>
<aside class="aside-note">
<p>The code that we'll look at is in the <code>elasticsearch</code> branch of the <code>LaunchCodeTraining/launchcart</code> repository.</p>
<p>To view the specific changes, look at <a href="https://gitlab.com/LaunchCodeTraining/launchcart/commit/cb706a682be3fb432fe4a3dd9c27963d76f30a5e" target="_blank">this commit</a>.</p>
</aside>
<ol>
<li>Add Gradle dependencies
<pre><code>compile('org.springframework.boot:spring-boot-starter-data-elasticsearch:1.5.10.RELEASE')
compile(group: 'org.elasticsearch.client', name: 'transport', version: '6.2.3')</code></pre></li>
<li>Create the <code>EsConfig</code> class to setup an embedded Elasticsearch instance</li>
<li>Write an integration test for the desired behavior</li>
<li>Create the <code>ItemDocument</code> and <code>ItemDocumentRepository</code> classes</li>
<li>Create <code>ItemDocumentController</code> and implement the <code>search</code> method</li>
<li>Create <code>EsController</code> and <code>EsUtils</code> to enable admin-oriented interactions with the ES instance</li>
</ol>
<aside class="aside-warning">
<p>This approach uses the <code>TransportClient</code> class to connect to a cluster over port 9300 via the transport protocol. This technique requires that the ES instance and the <code>TransportClient</code> have the <em>same major versions</em>. Elasticsearch is in the process of replacing this client with a REST API client that will be version agnostic.</p>
<p>Read more about the <a href="https://www.elastic.co/blog/state-of-the-official-elasticsearch-java-clients" target="_blank">state of the official Elasticsearch Java clients</a>.</p>
</aside>
<h2 id="your-tasks">Your Tasks</h2>
<p>On your own, study the code above and make sure you understand each of the components, referring to the linked resources below as necessary. When you come across something that isn't clear, talk through it with another student or with an instrutor.</p>
<h2 id="bonus-missions">Bonus Missions</h2>
<p>We looked at how to push a new item to Elasticsearch when creating it via the REST API. There are still several tasks that can be immediately carried out to fully integrate ES with the application. Try one more more of the following:</p>
<ul>
<li>Push a new document to ES when adding an item via the web view.</li>
<li>Update a document in ES when updating via the API or web view.</li>
<li>Add a search view that displays results of a fuzzy search. This may be done either via an AJAX request to <code>ItemDocumentRepository.search</code>, or by creating a new controller method that passes fuzzy search results into a template.</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="http://www.baeldung.com/spring-data-elasticsearch-tutorial" target="_blank">Spring Data Elasticsearch tutoria</a></li>
<li><a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/api/org/springframework/data/elasticsearch/repository/ElasticsearchRepository.html" target="_blank">ElasticSearchRepository</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-api/6.2/transport-client.html" target="_blank">TransportClient</a></li>
<li><a href="https://static.javadoc.io/org.elasticsearch/elasticsearch/2.4.0/org/elasticsearch/index/query/QueryBuilders.html" target="_blank">QueryBuilders</a></li>
<li><a href="http://www.baeldung.com/spring-data-elasticsearch-queries" target="_blank">Spring Data Elasticsearch Queries</a></li>
<li><a href="http://www.baeldung.com/spring-value-annotation" target="_blank">The @Value annotation</a></li>
</ul>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/highlight.pack.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/libgif.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', "UA-78748330-11", 'auto');
            ga('send', 'pageview');

        </script>

    </body>
</html>
