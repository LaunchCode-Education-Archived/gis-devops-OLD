<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Elasticsearch Queries Studio 2 :: GIS DevOps</title>

        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/highlight.launchcode.css">
        <link rel="stylesheet" href="https://education.launchcode.org/gis-devops/css/main.css">
        <link rel="stylesheet" href="https://djwbyvgln9kts.cloudfront.net/launch_ed_style/custom.css">
    </head>
    <body id='page-elasticsearch-queries-studio-2'>

        <header class="navbar navbar-default navbar-fixed-top">

            <ul class="nav navbar-nav">

                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle glyphicon glyphicon-menu-hamburger" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>
                        <ul class="dropdown-menu">
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/objectives/">
                                        Objectives
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/resources/">
                                        Resources
                                    </a>
                                </li>
                                                            <li class=" lc-button">
                                    <a href="https://education.launchcode.org/gis-devops/about/">
                                        About This Course
                                    </a>
                                </li>
                                                        <li role="separator" class="divider"></li>
                            <li>
                                <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch">Search This Site</a>
                            </li>
                        </ul>
                    </li>

                
            </ul>

            <div>
                <a class="navbar-brand site-title navbar-center" href="https://education.launchcode.org/gis-devops/">
                    <h1>GIS DevOps</h1>
                </a>
            </div>

            <div class="nav navbar-nav navbar-right">
                <a class="navbar-brand dabomb" href="https://education.launchcode.org/gis-devops/"></a>
            </div>

        </header>

        <!-- Search Modal -->
        <div id="modalSearch" class="modal fade" role="dialog">
           <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                   <button type="button" class="close" data-dismiss="modal">&times;</button>
                   <h4 class="modal-title">Search GIS DevOps</h4>
                </div>
                <div class="modal-body">
                    <script>
                      (function() {
                        var cx = "014657181352409571810:oq1krtyri4k";
                        var gcse = document.createElement('script');
                        gcse.type = 'text/javascript';
                        gcse.async = true;
                        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                        var s = document.getElementsByTagName('script')[0];
                        s.parentNode.insertBefore(gcse, s);
                      })();
                    </script>
                    <gcse:search></gcse:search>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

           </div>
        </div>

        <main class="container-fluid">
            <div class="row">

                <section id="content" class="col-sm-offset-2 col-sm-8">
                                        <h1>Elasticsearch Queries Studio 2</h1>
                    <h2 id="kibana-setup">Kibana Setup</h2>
<p>Install Kibana by running the following HomeBrew command:</p>
<pre><code class="language-nohighlight">$ brew install kibana</code></pre>
<p>To start the Kibana server in the background, run the following command:</p>
<pre><code class="language-nohighlight">$ kibana &amp;</code></pre>
<p>Navigate to <a href="localhost:5601"><a href="http://localhost:5601" target="_blank">http://localhost:5601</a></a> to view the running server.</p>
<p>Take a second to look at each of the pages below. They may be beneficial during your development:</p>
<ol>
<li><a href="http://localhost:5601/app/kibana#/dev_tools" target="_blank">Dev Tools</a> - Use the Dev Tools to run queries against your ElasticSearch (without cURL!)</li>
<li><a href="http://localhost:5601/app/kibana#/discover" target="_blank">Discover</a> - lists all of the data in your ElasticSearch instance.</li>
<li><a href="http://localhost:5601/app/kibana#/visualize" target="_blank">Visualize</a> - Perform analysis and create graphics describing your data.</li>
<li><a href="http://localhost:5601/app/kibana#/dashboard" target="_blank">Dashboard</a> - Combine graphs to give you a comprehensive picture of your data.</li>
</ol>
<aside class="aside-note">
<p>If your indices are listed in the Discover pane, you're likely missing a default index pattern. Add the <code>twitter</code> index as a default pattern. This can be changed later in the Management pane.</p>
</aside>
<h2 id="using-kibana">Using Kibana</h2>
<p>Open the <a href="http://localhost:5601/app/kibana#/dev_tools" target="_blank">Dev Tools</a>. Let's run a few queries.</p>
<p>Instead of using cURL. Queries can be put into Dev Tools by specifing the HTTP verb and the query text.</p>
<pre><code class="language-json">GET _search
{
  "query": {
    "match_all": {
      ""
    }
  }
}</code></pre>
<p>Also, notice that the left panel provides error messages with the line number of the error. In this case we have some errand quote marks in our query. Remove them and run the query again.</p>
<p>Next, open the <a href="http://localhost:5601/app/kibana#/discover" target="_blank">Discover Page</a>. This page provides a paginated list of all of the documents in your cluster. The search bar provides a quick way to search by attribute name.</p>
<p>Next, click on the <a href="http://localhost:5601/app/kibana#/visualize" target="_blank">Visualize Page</a>. This page allows you to create detailed graphs of your data.</p>
<p>Click on create a visualization and create a simple visualization of how many books are in the ElasticSearch.</p>
<h2 id="loading-data">Loading Data</h2>
<p>First, let's delete the data in the <code>twitter</code> index:</p>
<pre><code>$ curl -XDELETE 'localhost:9200/twitter'</code></pre>
<p>As we did yesterday, let's load some data. Create a script:</p>
<pre><code>$ touch load_data_geo.sh
$ chmod +x load_data_geo.sh</code></pre>
<p>Then copy/paste the contents of <a href="https://gist.github.com/chrisbay/8ef471ed1ac903c2bcaa2b82b49917a4" target="_blank">this gist</a>. Save and run the script:</p>
<pre><code>$ ./load_data_geo.sh</code></pre>
<p>Verify that the mapping was created properly by running the following command and checking that the <code>location</code> field is of type <code>geo_point</code>:</p>
<pre><code>$ curl 'localhost:9200/twitter/_mappings?pretty'</code></pre>
<p>If something went wrong, delete the index, get help from an instructor, and try again.</p>
<h2 id="your-tasks">Your Tasks</h2>
<p>Now you'll get some practice with Elasticsearch. Carry out each of the following tasks. Once you have a successful query/command for each, save the commend in a <code>.txt</code> file for submission</p>
<ol>
<li>Find all tweets with between 5 and 10 likes, inclusive of those endpoints.</li>
<li>Find all tweets by Mary Jones that have at least 2 likes</li>
<li>Find all tweets that contain the text &quot;Elasticsearch&quot;, including mispellings up to distance of 3 away.</li>
<li>Find all tweets that have a location (Hint: Try the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html" target="_blank">exists query</a>)</li>
<li>Find all tweets that do not have a location</li>
<li>Find the average number of likes for tweets that have a location</li>
<li>Find the average number of likes for tweets that do not have a location</li>
<li>Find all tweets with locations within 500km of Boise, ID</li>
</ol>
<h2 id="turning-in-your-work">Turning In Your Work</h2>
<p>Submit your queries to an instructor via Slack once you're finished.</p>
                                    </section>

            </div>
        </main>

        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/highlight.pack.js"></script>
        <script type="text/javascript" src="https://education.launchcode.org/gis-devops/js/libgif.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');

                // Syntax highlighting
                hljs.configure({ displayLabels: true });
                hljs.initHighlightingOnLoad();
            });
        </script>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', "UA-78748330-11", 'auto');
            ga('send', 'pageview');

        </script>

    </body>
</html>
